!!! Info "前提条件"
    * 特になし

## このプラグインで出来ること

* メモ帳ベースで入力受け付けます
* 高機能テキストエディタ（Azukiエディタ）による原稿作成
* 行単位での字幕送信機能
* ファイル操作（新規作成・開く・保存・名前を付けて保存）
* 外部APIによる自動制御
* キーボードショートカット完全対応
* 自動Enter送信モード

!!! Info "こういう時に使おう"
    * 原稿を用意して、その通りに発話したり表示したいときに使いましょう

##　有効化

![direct](images/plugin_InputAssist_p1.png)

* プラグインを使うチェックをONにしてください。

## 設定

![direct](images/plugin_InputAssist_p2.png)

* ウィンドウが出ます。
* カーソル行でF1キーを押すと送信できます。

## 台本ファイルの作り方

### ファイル形式
- **拡張子**: .txt（テキストファイル）
- **文字コード**: UTF-8
- **改行コード**: Windows（CR+LF）推奨

### 基本的な書式
```
こんにちは、みなさん
今日はいい天気ですね
それでは始めていきましょう

## 次のトピック
ここから新しい話題です
説明文が続きます
```

### 使い方のコツ

#### 1行1文で作成
- 1行が1つの送信単位になります
- 長すぎる文は適度に改行で分割
- 空行は無視されます

#### コメント行の活用
- `#` で始まる行はコメント（送信されない）
- `//` で始まる行もコメント
- 台本の注釈やメモに使用

```
# これはコメント行（送信されません）
// これもコメント行
こんにちは（これは送信される）
# 休憩タイミング
次の話題に移ります（これも送信される）
```

#### セクション分け
```
=== 第1章 ===
導入部分の内容
説明文

=== 第2章 ===  
本題の内容
詳細説明
```

### ファイルの保存・読み込み

#### 新規作成
- `Ctrl+Shift+N` で新しいファイル作成
- エディタで直接文章を入力
- `Ctrl+S` で保存

#### 既存ファイル読み込み
- `Ctrl+Shift+O` でファイルを選択
- UTF-8で保存されたテキストファイルを選択
- メモ帳で作成したファイルも読み込み可能

!!! Tips "台本の効果的な使い方"
    * 配信前に台本を用意しておく
    * プレゼンテーション資料と連動
    * 読み間違い防止のための原稿確認
    * ライブ配信での進行管理

## 高機能エディタの詳細

### Azukiエディタの機能

| 機能 | 説明 | 設定 |
|:-----|:-----|:-----|
| 行番号表示 | エディタ左側に行番号を表示 | ShowsLineNumber |
| 水平ルーラー | 上部に文字位置の目安を表示 | ShowsHRuler |
| 全角スペース可視化 | 全角スペースを記号で表示 | ShowsFullWidthSpace |
| Tab/改行表示 | 制御文字の可視化 | ShowsTab, ShowsEol |
| 現在行ハイライト | カーソル行の背景色変更 | HighlightsCurrentLine |
| 対応括弧表示 | 括弧のペアをハイライト | HighlightsMatchingBracket |
| 変更状態表示 | 未保存変更のインジケータ | ShowsDirtBar |
| ワードラップ | 長い行の自動折り返し | WordWrap |

### キーボードショートカット

#### ファイル操作
| 操作 | ショートカット | 説明 |
|:-----|:-------------|:-----|
| 新規作成 | `Ctrl+Shift+N` | 新しいファイルを作成 |
| 開く | `Ctrl+Shift+O` | 既存ファイルを開く |
| 保存 | `Ctrl+S` | 現在のファイルを保存 |
| 名前を付けて保存 | `Ctrl+Shift+S` | 別名でファイル保存 |

#### 編集操作  
| 操作 | ショートカット | 説明 |
|:-----|:-------------|:-----|
| 切り取り | `Ctrl+X` | 選択テキストを切り取り |
| コピー | `Ctrl+C` | 選択テキストをコピー |
| 貼り付け | `Ctrl+V` | クリップボードから貼り付け |
| 削除 | `Ctrl+D` | 選択テキストを削除 |
| 全選択 | `Ctrl+A` | 全てのテキストを選択 |
| 元に戻す | `Ctrl+Z` | 直前の操作を取り消し |

#### 字幕送信操作
| 操作 | ショートカット | 説明 |
|:-----|:-------------|:-----|
| 行送信 | `F1` | 現在行をYNC_Neoに送信 |
| 自動Enter | 設定項目 | Enter押下時に自動送信 |

### 外部API制御

#### コマンド一覧
| コマンド | 説明 | 使用例 |
|:---------|:-----|:-------|
| `prev` | 前の行に移動 | 台本の行戻し |
| `next` | 次の行に移動 | 台本の行送り |
| `send` | 現在行を送信 | 外部からの送信トリガー |
| `sendnext` | 送信後に次行へ移動 | 連続送信の自動化 |

#### API使用例
```javascript
// 次の行に移動
plugin.onCommand({
  "target": "Plugin_InputAssist", 
  "command": "next"
});

// 現在行を送信して次の行へ
plugin.onCommand({
  "target": "Plugin_InputAssist",
  "command": "sendnext"
});
```

### ウィンドウ管理

#### 自動制御
* **プラグイン有効時**: ウィンドウが自動的に表示
* **プラグイン無効時**: ウィンドウが自動的に非表示
* **位置記憶**: ウィンドウサイズと位置を自動保存

#### ファイル形式
* **対応形式**: テキストファイル (*.txt)
* **エンコーディング**: UTF-8対応
* **改行コード**: Windows形式 (CRLF) 推奨

### 実用的な使い方

#### 台本読み上げ
1. 台本をテキストファイルで準備
2. InputAssistで台本ファイルを開く
3. F1キーで行単位に送信しながら進行
4. 自動Enterモードで連続送信も可能

#### プレゼンテーション制御
1. 発表内容を行単位で準備
2. 外部スクリプトからAPI制御
3. タイミングに合わせて自動送信

#### ライブ配信サポート
1. 配信用の文章を事前準備
2. 必要に応じてリアルタイム編集
3. 視聴者コメントへの定型応答用途

### トラブルシューティング

#### ファイルが開けない
* ファイルの文字エンコーディングを確認
* ファイルが他のアプリケーションで使用中でないか確認
* ファイルパスに特殊文字が含まれていないか確認

#### 送信が動作しない
* YNC_Neo本体との接続状況を確認
* 他のプラグインとの競合を確認
* F1キーが他のアプリケーションに取られていないか確認

#### 表示が崩れる
* フォント設定を確認
* ウィンドウサイズを調整
* 画面解像度やDPI設定を確認
