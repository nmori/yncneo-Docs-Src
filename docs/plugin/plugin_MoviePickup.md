!!! Info "前提条件"
    * なし

## このプラグインで出来ること

* 音声認識結果に応じて動画ファイルを自動再生します
* 辞書ベースで認識ワードと動画ファイルを関連付け
* 専用ウィンドウで動画を表示
* 表示タイミングと表示時間の詳細制御

## 有効化

![有効化](images/plugin_moviepickup_p1.png)

* プラグインを使うチェックをONにしてください。

## 動作の仕組み

このプラグインは、音声認識された文章の中から特定のキーワードを検出し、対応する動画ファイルを自動的に再生する機能を提供します。

主な機能：
* **辞書ベースの動画選択**: CSV辞書で「認識結果→動画ファイル」の対応を定義
* **専用再生ウィンドウ**: MediaElementを使用した動画再生
* **表示時間制御**: 再生終了後の自動クリア、時間経過でのクリア
* **HTTPクライアント**: 外部からの動画URL取得に対応

## 設定

![設定](images/plugin_moviepickup_p2.png)

### ファイル特定辞書

|設定項目|説明|
|:--|:---|
|辞書ファイルパス|CSV形式の辞書ファイルを指定|
|フォーマット|「認識結果,ファイル名」の形式でUTF-8エンコード|
|ファイル選択ボタン（…）|辞書ファイルを参照して選択|

### 動画辞書ファイルの作り方

#### CSVファイル形式
- **ファイル名**: 任意（例：movie_dict.csv）
- **文字コード**: UTF-8（必須）
- **形式**: 「キーワード,動画ファイル名」の1行1ペア

#### 具体的な辞書例
```csv
おはよう,morning.mp4
こんにちは,hello.mp4
ありがとう,thanks.mp4
お疲れ様,otsukaresama.mp4
すごい,amazing.gif
面白い,funny.avi
びっくり,surprise.mov
```

#### 対応動画形式
- **MP4**: 最も推奨される形式
- **AVI**: Windows標準対応
- **MOV**: QuickTime形式
- **WMV**: Windows Media形式
- **GIF**: アニメーション画像（短時間向け）

#### ファイルの作成手順

##### 1. メモ帳で作成
1. メモ帳を開く
2. 上記の形式で「キーワード,ファイル名」を1行ずつ入力
3. 「名前を付けて保存」を選択
4. **重要**: 「文字コード」を「UTF-8」に変更
5. 拡張子を「.csv」で保存

##### 2. Excelで作成
1. Excelを開く
2. A列に「キーワード」、B列に「ファイル名」を入力
3. 「名前を付けて保存」を選択
4. 保存形式で「**CSV UTF-8(コンマ区切り)(*.csv)**」を選択
5. 保存する

### ファイル配置方法

#### 推奨フォルダ構成
```
ゆかコネフォルダ/
├── movie_dict.csv（辞書ファイル）
└── movies/（動画フォルダ）
    ├── morning.mp4
    ├── hello.mp4
    ├── thanks.mp4
    └── ...
```

#### 設定手順
1. 動画ファイルを「movies」フォルダに配置
2. 辞書ファイルを作成
3. プラグイン設定で「動画フォルダ」に「movies」フォルダを指定  
4. 「辞書ファイルパス」に作成したCSVファイルを指定

!!! Warning "よくあるエラーと対処法"
    **文字化けする場合**
    - ファイルの文字コードがUTF-8以外になっている
    - メモ帳で保存時に必ず「UTF-8」を選択
    
    **動画が再生されない場合**  
    - 動画ファイルのパスが間違っている
    - 対応していない動画形式を使用している
    - 動画ファイルが破損している
    
    **キーワードが認識されない場合**
    - CSV形式が間違っている（カンマの位置など）
    - キーワードの表記が音声認識結果と異なっている

### オプション設定

|設定項目|説明|デフォルト値|
|:--|:---|:---|
|動画フォルダ|動画ファイルが保存されているフォルダ|-|
|フォルダ選択ボタン（…）|動画フォルダを参照して選択|-|

#### 表示クリア設定

* **再生が終わったら（One Play）**: 動画再生終了と同時にウィンドウをクリア
* **文確定後、時間経過で消す（by Time）**: 指定秒数経過後に自動クリア
  - 表示時間: 秒数を数値で指定（デフォルト: 10秒）

### 動画画面制御

* **動画画面（Movie）ボタン**: 専用の動画再生ウィンドウを表示/非表示

## 使用例

### リアクション動画の自動再生

1. **辞書ファイルの作成**:
```csv
すごい,reaction_amazing.mp4
ありがとう,reaction_thanks.mp4
びっくり,reaction_surprise.mp4
```

2. **設定手順**:
   - 動画フォルダに動画ファイルを配置
   - プラグイン設定で辞書ファイルを指定
   - 動画画面ボタンで再生ウィンドウを表示

3. **自動動作**:
   - 音声認識で「すごい」と発話 → reaction_amazing.mp4 が自動再生

### 配信演出での活用

* **挨拶動画**: 「おはよう」「こんにちは」でオープニング動画
* **感謝動画**: 「ありがとう」で感謝エフェクト動画
* **リアクション**: 感情を表す言葉で対応エモート動画

### プレゼンテーションでの使用

```csv
グラフ,chart_animation.mp4
実演,demo_video.mp4
まとめ,summary_slide.mp4
```

発話内容に応じて自動的に関連動画が表示されます。

## 技術仕様

### 対応動画形式
* MP4, AVI, WMV, MOV
* MediaElement（WPF）で再生可能な形式

### ウィンドウサイズ
* デフォルト: 200×300ピクセル
* 設定ファイルで自動保存・復元

### タイマー機能
* 文章確定後、指定時間で自動クリア
* デフォルト: 10秒（設定で変更可能）

## トラブルシューティング

!!! Warning "注意事項"
    * 辞書ファイルはUTF-8エンコーディングで保存してください
    * 動画ファイルパスは絶対パスまたは動画フォルダからの相対パス
    * HTTPクライアントタイムアウト: 5秒

### 動画が表示されない場合

1. **辞書設定の確認**:
   - ファイル形式: CSV（カンマ区切り）
   - エンコーディング: UTF-8
   - 形式: 「認識結果,ファイル名」

2. **ファイルパスの確認**:
   - 動画フォルダの設定が正しいか
   - ファイル名に日本語や特殊文字が含まれていないか

3. **動画形式の確認**:
   - MediaElementで再生可能な形式か
   - ファイルが破損していないか

## 関連プラグイン

* [動画再生](plugin_MediaPlayer.md) - 高機能な動画プレイヤー
* [フォト読み込み](plugin_photopickup.md) - 静止画の自動表示
* [辞書](plugin_dictionary.md) - テキスト置換辞書
* [正規表現](plugin_regexp.md) - 高度なパターンマッチング