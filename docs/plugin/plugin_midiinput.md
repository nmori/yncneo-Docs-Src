!!! Info "前提条件"
    * WindwosのMIDI入力デバイスにアクセスできる場合のみ使用可能

## このプラグインで出来ること

* MIDIデバイスから入力された音程コードを表示します。
* リアルタイムMIDI入力処理
* 音楽記号表記での音階表示（[C4], [G#3]等）
* カスタムテキストマッピング機能
* MIDIチャンネルフィルタリング
* 押下ノート状態の可視化
* CSV形式でのマッピング管理

!!! Info "この機能はWindows側の安定度にかなり左右されます"
    * WindowsのMIDIインタフェイス周りが不安定な場合、通信が途切れることがあります

##　有効化

![再生](images/plugin_midiinput_p1.png)

* プラグインを使うチェックをONにしてください。

## 設定

* どのデバイスから入力するかを選んで接続してください。

## 高度な機能

### MIDI デバイス管理

#### デバイス選択・接続
* **デバイス一覧**: システム内の利用可能MIDIデバイスを自動検出
* **リアルタイム接続**: プラグイン動作中のデバイス接続・切断
* **デバイス更新**: 「デバイス再読込」ボタンで最新状況を反映
* **接続状態表示**: 現在の接続状況をリアルタイム表示

#### 対応デバイス
* **ハードウェア**: MIDI キーボード、コントローラー
* **ソフトウェア**: 仮想MIDIポート、DAWアプリケーション
* **USB MIDI**: USB接続のMIDIデバイス全般

### 音階処理システム

#### 音楽記号表記
* **表記形式**: `[音名]オクターブ番号`
* **音名表記**: C, C#, D, D#, E, F, F#, G, G#, A, A#, B
* **オクターブ**: 0-10 (MIDI仕様準拠)
* **例**: C4 (中央ハ), G#3 (ソのシャープ), F5 (高音域ファ)

#### ノート状態管理
* **押下ノート追跡**: 現在押されているノートのリスト表示
* **同時押し対応**: 複数ノート同時押下の検出・表示
* **リリース検出**: ノート離し（Note Off）の適切な処理

### テキストマッピング機能

#### カスタムテキスト変換
* **ノート→テキスト**: MIDIノート番号を任意のテキストに変換
* **用途例**: 
  - C4 → "ド"
  - G#3 → "ソのシャープ"
  - C5 → "高いド"

#### CSV マッピング管理
* **ファイル形式**: UTF-8エンコードCSV
* **フォーマット**: "MIDIノート, 出力テキスト"
* **例**:
```csv
60,"中央ハ"
67,"ト音"
72,"高音ハ"
```

#### グリッドエディタ
* **インターフェース**: DataGridView による直接編集
* **リアルタイム更新**: 編集内容の即座反映
* **保存・読込**: CSV ファイルでの設定管理

### MIDIチャンネル制御

#### チャンネルフィルタリング
* **機能**: 特定MIDIチャンネルのみを処理対象にする
* **チャンネル範囲**: 1-16 (MIDI標準)
* **用途**: マルチチャンネル機器での特定パートのみ抽出
* **設定**: チャンネル番号指定または全チャンネル受信

### 送信モード設定

#### 出力オプション
| モード | 出力内容 | 用途 |
|:------|:---------|:-----|
| 音楽記号送信 | [C4], [G#3] 等 | 音楽理論学習、楽譜読み |
| マッピング送信 | カスタムテキスト | 歌詞、効果音、コマンド |

### 技術仕様

#### MIDI処理
* **ライブラリ**: NAudio.Midi
* **対応範囲**: MIDI 1.0 標準準拠
* **ノート範囲**: 0-127 (C-1 ～ G9)
* **フィルタリング**: MIDIクロック除去（248, 254, >30000）

### トラブルシューティング

#### デバイスが認識されない
* **確認事項**: デバイスの接続とドライバ状況
* **対処法**: デバイス再読込ボタンの使用
* **システム設定**: Windows MIDIデバイス設定の確認

#### 音が出力されない
* **送信モード**: 適切な送信モードの選択確認
* **チャンネル設定**: MIDIチャンネル制限の確認
* **マッピング**: カスタムマッピングの設定状況確認

## 使い方
1. MIDI入力があると、音程信号が入力として送付されます
