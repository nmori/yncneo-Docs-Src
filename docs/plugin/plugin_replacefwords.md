!!! Info "前提条件"
    * なし
    * AIフィルタリング機能を使用する場合は、OpenAI APIキーが必要

## このプラグインで出来ること

* 不適切な言葉（F-Words）を自動的に検出して置換します
* カスタム辞書を使用して特定の単語をフィルタリングします
* AIを使用した高度なコンテンツフィルタリングが可能です

## 有効化

![有効化](images/plugin_replacefwords_p1.png)

* プラグインを使うチェックをONにしてください。

## 動作の仕組み

このプラグインは、音声認識された文字列から不適切な言葉を検出し、自動的に置換する機能を提供します。

### フィルタリング方式

1. **辞書ベースフィルタリング**
   - 事前定義された単語リストによる検出
   - カスタム辞書の追加が可能
   - 単語を「***」や指定文字に置換

2. **AIベースフィルタリング**
   - OpenAI APIを使用した文脈判断
   - より自然な置換表現の生成
   - 文章全体の意味を保ちながらフィルタリング

## 設定

![設定](images/plugin_replacefwords_p2.png)

### 禁止ワードの置き換え

#### AIフィルタリング（ChatGPT）
* **チェックボックス**: ChatGPTによる自動フィルタリングの有効/無効
* **要件**: 支援版Lv3以上 または OpenAI APIキー
* **処理内容**: 差別用語、政治用語、セクシャルな言葉などを自動判定・置換
* **注意**: ChatGPTの応答待ちのため処理が若干遅くなります

#### 辞書フィルタリング
* **チェックボックス**: 辞書ベースフィルタリングの有効/無効
* **辞書ファイル**: テキストファイルを指定（1行に1単語）
* **ファイル選択ボタン（…）**: 辞書ファイルを参照選択
* **Reloadボタン**: 辞書ファイルの再読み込み

### 置換方式の設定

|設定項目|動作|例|
|:--|:---|:---|
|すべて「***」で置換|該当単語を完全に「***」に置換|「馬鹿」→「***」|
|一部文字のみ置換|先頭文字以外を「*」で置換|「馬鹿」→「馬*」|

### 設定画面の機能

* **ヘルプボタン（？）**: オンラインヘルプを開く
* **Reloadボタン**: 辞書ファイルの変更を即座に反映

## 辞書ファイルの形式

辞書ファイルはテキストファイル（.txt）で、1行に1単語を記載します：

```
不適切な単語1
不適切な単語2
不適切な単語3
```

### カスタム置換の設定

タブ区切りで置換後の文字を指定することも可能です：

```
不適切な単語1	[削除]
不適切な単語2	○○○
不適切な単語3	***
```

## 使用例

### 配信での活用

ライブ配信で視聴者に適切なコンテンツを提供：

* 子供向け配信での自動フィルタリング
* 企業配信でのコンプライアンス対応
* 教育コンテンツでの言葉の制限

### AI フィルタリングの例

**入力**: 「この○○○な状況は本当に困る」
**出力**: 「この困難な状況は本当に困る」

AIフィルタリングは文脈を理解して、より自然な置換を行います。

## 詳細設定

### AIモデル設定

使用されるAIモデル：
* **モデル**: gpt-4.1-mini（コード内設定）
* **Temperature**: 0.5（適度な創造性）
* **Max Tokens**: 1000（応答最大長）

### 内蔵プロンプト

AIフィルタリングで使用される内蔵プロンプト：

#### システムロール
```
You are a modifier and only modified statements are permitted to be answered.
If a word contains violence, sexuality, political ideology, discrimination or a swearword, 
replace the word with '*'. Answers should be in the same language as the text and replies should be in response only.
```

#### 処理内容
* 暴力的表現、性的表現、政治的イデオロギー、差別的表現、罵倒語を「*」で置換
* 元の言語で応答
* 修正された文章のみを返答

### 処理タイミング

* **確定文章のみ**: 音声認識が確定した文章（fixedText=true）のみ処理
* **削除・クリア除外**: 削除された文章やクリアされた文章は処理しない
* **同時処理**: 辞書フィルタリングとAIフィルタリングは両方有効時に順次実行

## トラブルシューティング

!!! Warning "注意事項"
    * 過度なフィルタリングは会話の自然さを損なう可能性があります
    * AIフィルタリングは処理時間がかかる場合があります
    * 辞書ファイルは UTF-8 エンコーディングで保存してください

### フィルタリングが機能しない場合

1. 辞書ファイルのパスと形式を確認
2. プラグインが有効になっているか確認
3. 文字エンコーディングを確認（UTF-8推奨）

## 関連プラグイン

* [辞書](plugin_dictionary.md) - 一般的な単語置換
* [正規表現](plugin_regexp.md) - パターンマッチングによる置換
* [GPT3整形/AIアシスタント](plugin_GPT3.md) - AI による文章整形